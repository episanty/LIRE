Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["LIRE: Lissajous-figure Reconstruction for nonlinear \
polarization tomography of bichromatic fields",
 FontSize->
  24]], "Title",ExpressionUUID->"7f209d14-bba5-4705-b124-d36a87c1beee"],

Cell["\[Copyright] Emilio Pisanty 2019. Licensed under GPL and CC-BY-SA.", \
"Text",ExpressionUUID->"d33e8ba8-08ed-4b04-9664-dabb00321cca"],

Cell[CellGroupData[{

Cell["Introduction", "Subchapter",
 CellTags->
  "Introduction",ExpressionUUID->"7ff79276-309e-493c-89fa-91d9bc963997"],

Cell[CellGroupData[{

Cell["Readme", \
"Subsection",ExpressionUUID->"d2f11658-47f6-4acb-beb4-751bcdb6d763"],

Cell[CellGroupData[{

Cell[TextData[{
 "LIRE is a Mathematica package for reconstructing the polarization Lissajous \
figures of bichromatic ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Omega]", ":", 
    RowBox[{"2", "\[Omega]"}]}], TraditionalForm]],ExpressionUUID->
  "7fbd7735-d8a0-4428-a08f-336f3ff24c15"],
 " light-beam combinations, as described in the paper\n\n \[Bullet] Knotting \
fractional-order knots with the polarization state of light. E. Pisanty et \
al. ",
 StyleBox["Nature Photonics",
  FontSlant->"Italic"],
 ", in press (2019), ",
 ButtonBox["arXiv:1808.05193",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/abs/1808.05193"], None},
  ButtonNote->"https://arxiv.org/abs/1808.05193"],
 ".\n\n"
}], "Text",
 CellGroupingRules->{
  GroupTogetherGrouping, 
   10000.},ExpressionUUID->"9a8d960d-6d88-4fad-945a-a1f7691d577b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"LIRE", ":", " ", 
    RowBox[{"Lissajous", "-", 
     RowBox[{
     "figure", " ", "Reconstruction", " ", "for", " ", "nonlinear", " ", 
      "polarization", " ", "tomography", " ", "of", " ", "bichromatic", " ", 
      RowBox[{"fields", "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\[Copyright]", " ", "Emilio", " ", "Pisanty"}], ",", " ", 
    "2019"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"For", " ", "more", " ", "information"}], ",", 
    RowBox[{
     RowBox[{"see", " ", 
      RowBox[{"https", ":"}]}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{"github", ".", "com"}], "/", "episanty"}], "/", "LIRE"}]}]}], 
   " ", "*)"}]}]], "Input",
 CellGroupingRules->{GroupTogetherGrouping, 10000.},
 InitializationCell->
  True,ExpressionUUID->"ac44aa9d-1eed-401b-86e5-fd78cdf4c3f0"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Licensing", \
"Subsection",ExpressionUUID->"a68d7089-cb80-4cb6-9591-e6af9b4adf98"],

Cell[TextData[{
 "This code is dual-licensed under the GPL and CC-BY-SA licenses; you are \
free to use, modify, and redistribute it, but you must abide by the terms in \
either of those licenses.\n\nIn addition to that ",
 StyleBox["legal",
  FontSlant->"Italic"],
 " obligation, if you use this code in calculations for an academic \
publication, you have an ",
 StyleBox["academic",
  FontSlant->"Italic"],
 " obligation to cite it correctly. For that purpose, please cite the ",
 StyleBox["Nature Photonics",
  FontSlant->"Italic"],
 " paper above, or use a direct citation to the code such as\n\n    E. \
Pisanty. LIRE: Lissajous-figure reconstruction for nonlinear polarization \
tomography of bichromatic fields. https://github.com/episanty/LIRE (2019).\n  \
  \nIf you wish to include a DOI in your citation, please use one of the \
numbered-version releases."
}], "Text",ExpressionUUID->"e4dc8b2a-3f71-489d-9066-76331a14d173"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Implementation", \
"Subchapter",ExpressionUUID->"a9df0d23-9b67-49e1-b9e3-1a72859431af"],

Cell[CellGroupData[{

Cell["Initialization and package infrastructure", \
"Subsection",ExpressionUUID->"577dcd29-2522-4f35-8241-66fdaeaf85c3"],

Cell[CellGroupData[{

Cell["Package initialization", \
"Subsubsection",ExpressionUUID->"3360a514-50e8-4e8e-b233-b9839b0b2fd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<LIRE`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"a3fe781e-8db1-4219-aeaa-3f8c593d8fa5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Version number", "Subsubsection",
 CellTags->
  "version-section",ExpressionUUID->"7967eb43-4226-4d1a-9004-c579590a2692"],

Cell["\<\
The variable $LIREversion gives the version of the LIRE package currently \
loaded, and its timestamp\
\>", "Text",ExpressionUUID->"a28c2cef-44a8-4f88-a13e-dcfb21613da5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$LIREversion", "::", "usage"}], "=", 
   "\"\<$LIREversion prints the current version of the LIRE package in use \
and its timestamp.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$LIREtimestamp", "::", "usage"}], "=", 
   "\"\<$LIREtimestamp prints the timestamp of the current version of the \
LIRE package.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$LIREversion", ":=", 
   RowBox[{"\"\<LIRE v1.0.0, \>\"", "<>", "$LIREtimestamp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"06ed43a3-15ef-433b-bd29-4de20889334f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], \
"Input",ExpressionUUID->"f783f477-ece6-4850-8576-bae08557b269"],

Cell["\<\
The timestamp is updated every time the notebook is saved via an appropriate \
notebook option, which is set by the code below.\
\>", "Text",ExpressionUUID->"4cfda74d-345c-40a5-b2fd-c76ee540fdb0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EvaluationNotebook", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"NotebookEventActions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<MenuCommand\>\"", ",", "\"\<Save\>\""}], "}"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NotebookWrite", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Cells", "[", 
              RowBox[{"CellTags", "\[Rule]", "\"\<version-timestamp\>\""}], 
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"Cell", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"BoxData", "[", 
               RowBox[{"RowBox", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Begin[\\\"`Private`\\\"];$LIREtimestamp=\\\"\>\"", "<>", 
                  RowBox[{"DateString", "[", "]"}], "<>", 
                  "\"\<\\\";End[];\>\""}], "}"}], "]"}], "]"}], 
              "\[IndentingNewLine]", ",", "\"\<Input\>\"", ",", 
              RowBox[{"InitializationCell", "\[Rule]", "True"}], ",", 
              RowBox[{"CellTags", "\[Rule]", "\"\<version-timestamp\>\""}]}], 
             "\[IndentingNewLine]", "]"}], ",", "None", ",", 
            RowBox[{"AutoScroll", "\[Rule]", "False"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"NotebookSave", "[", "]"}]}], "\[IndentingNewLine]", 
         ")"}]}], ",", 
       RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}], 
  ";"}]], "Input",ExpressionUUID->"9ab8bc8d-e5f1-4dac-984a-ed686444e4a4"],

Cell["To reset this behaviour to normal, evaluate the cell below", \
"Text",ExpressionUUID->"79a09c0b-5ada-4820-b171-adf7087428dd"],

Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"NotebookEventActions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<MenuCommand\>\"", ",", "\"\<Save\>\""}], "}"}], 
       "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"NotebookSave", "[", "]"}], ")"}]}], ",", 
      RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "}"}]}]}], 
  "]"}]], "Input",ExpressionUUID->"8b66dfc7-af3c-410b-8fa6-50468f5c81a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Timestamp", \
"Subsubsection",ExpressionUUID->"e4ba443b-8328-40ca-a2ea-2f059da3b0d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";", 
  RowBox[{"$LIREtimestamp", "=", "\"\<Sun 17 Mar 2019 05:00:50\>\""}], ";", 
  RowBox[{"End", "[", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellTags->
  "version-timestamp",ExpressionUUID->"fa6a2079-9019-4956-86f9-eb95d49e4b49"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directory", \
"Subsubsection",ExpressionUUID->"a08baa08-be3a-4c5a-841c-4752dd040189"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$LIREdirectory", "::", "usage"}], "=", 
   "\"\<$LIREdirectory is the directory where the current LIRE package \
instance is located.\>\""}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"7118bda8-aff5-475a-947f-062f4095057b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"softLinkTestString", "=", 
      RowBox[{"StringSplit", "[", 
       RowBox[{
        RowBox[{"StringJoin", "[", 
         RowBox[{"ReadList", "[", 
          RowBox[{
           RowBox[{"\"\<! ls -la \>\"", "<>", 
            RowBox[{"StringReplace", "[", 
             RowBox[{"$InputFileName", ",", 
              RowBox[{"{", 
               RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], "}"}]}], 
             "]"}]}], ",", "String"}], "]"}], "]"}], ",", "\"\< -> \>\""}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "softLinkTestString", "]"}], ">", "1"}], ",", 
      RowBox[{"(*", 
       RowBox[{
       "Testing", " ", "in", " ", "case", " ", "$InputFileName", " ", "is", 
        " ", "a", " ", "soft", " ", "link", " ", "to", " ", "the", " ", 
        "actual", " ", 
        RowBox[{"directory", "."}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"$LIREdirectory", "=", 
       RowBox[{"StringReplace", "[", 
        RowBox[{
         RowBox[{"DirectoryName", "[", 
          RowBox[{
          "softLinkTestString", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], "}"}]}], "]"}]}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"$LIREdirectory", "=", 
        RowBox[{"StringReplace", "[", 
         RowBox[{
          RowBox[{"DirectoryName", "[", "$InputFileName", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\< \>\"", "\[Rule]", "\"\<\\\\ \>\""}], "}"}]}], 
         "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"2b7faeb3-0b7f-4278-a4ce-f42af4a5710c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Git commit hash and message", \
"Subsubsection",ExpressionUUID->"1ff533b2-9a38-4429-9b2e-e43ce4aa6011"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$LIREcommit", "::", "usage"}], "=", 
   "\"\<$LIREcommit returns the git commit log at the location of the LIRE \
package if there is one.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$LIREcommit", "::", "OS"}], "=", 
   "\"\<$LIREcommit has only been tested on Linux.\>\""}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f3d4f095-f46c-475e-8c2f-250286e5d436"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$LIREcommit", ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"$OperatingSystem", "\[NotEqual]", "\"\<Unix\>\""}], ",", 
       RowBox[{"Message", "[", 
        RowBox[{"$LIREcommit", "::", "OS"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"Riffle", "[", 
       RowBox[{
        RowBox[{"ReadList", "[", 
         RowBox[{
          RowBox[{
          "\"\<!cd \>\"", "<>", "$LIREdirectory", "<>", 
           "\"\< && git log -1\>\""}], ",", "String"}], "]"}], ",", 
        RowBox[{"{", "\"\<\\n\>\"", "}"}]}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"a8480c42-c519-423d-a120-4aa44435c59d"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["UnitE", \
"Subsection",ExpressionUUID->"c5ed2ca0-9b26-48d2-bc4d-add57320a732"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"UnitE", "::", "usage"}], "=", 
   "\"\<UnitE[1] and UnitE[-1] return, respectively, \!\(\*FractionBox[\(1\), \
SqrtBox[\(2\)]]\){1,\[ImaginaryI]} and \!\(\*FractionBox[\(1\), \
SqrtBox[\(2\)]]\){1,-\[ImaginaryI]}.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitE", "[", "1", "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", "\[ImaginaryI]"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UnitE", "[", 
    RowBox[{"-", "1"}], "]"}], "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["2"]], 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"4a177859-4e6e-4aef-85fd-a223127e7011"]
}, Closed]],

Cell[CellGroupData[{

Cell["EnsureRightCircularFundamental", \
"Subsection",ExpressionUUID->"06ad99ca-5841-4134-ba0f-b0c700289d49"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"EnsureRightCircularFundamental", "::", "usage"}], "=", 
    "\"\<EnsureRightCircularFundamental[{E1p,E1m,E2p,E2m}] ensures that the \
fundamental has right-circular polarization (i.e. |E1p|>|E1m|) by swapping \
the input to \
{E1m\[Conjugate],E1p\[Conjugate],E2m\[Conjugate],E2p\[Conjugate]} if \
necessary.\>\""}], ";"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnsureRightCircularFundamental", "[", 
   RowBox[{"{", 
    RowBox[{"E1p_", ",", "E1m_", ",", "E2p_", ",", "E2m_"}], "}"}], "]"}], ":=", 
  RowBox[{"If", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Abs", "[", "E1p", "]"}], ">", 
     RowBox[{"Abs", "[", "E1m", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"E1p", ",", "E1m", ",", "E2p", ",", "E2m"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"E1m", "\[Conjugate]"}], ",", 
      RowBox[{"E1p", "\[Conjugate]"}], ",", 
      RowBox[{"E2m", "\[Conjugate]"}], ",", 
      RowBox[{"E2p", "\[Conjugate]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"bf9244d6-ef81-456c-9ee9-3dca72110bbb"]
}, Closed]],

Cell[CellGroupData[{

Cell["PhaseNormalization", \
"Subsection",ExpressionUUID->"41715a3c-7b33-4bb6-b0da-bd7cd12d77cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PhaseNormalization", "::", "usage"}], "=", 
    "\"\<PhaseNormalization[{E1p,E1m,E2p,E2m}] Normalizes the field phases so \
that E1p is real and positive, by multiplying by an appropriate factor of \
\!\(\*SuperscriptBox[\(\[ExponentialE]\), \(\(-\[ImaginaryI]\)\\\ \[Phi]\)]\) \
on E1 and \!\(\*SuperscriptBox[\(\[ExponentialE]\), \(\(-2\) \[ImaginaryI]\\\ \
\[Phi]\)]\) on E2.\>\""}], ";"}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PhaseNormalization", "[", 
   RowBox[{"{", 
    RowBox[{"E1p_", ",", "E1m_", ",", "E2p_", ",", "E2m_"}], "}"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Phi]", "=", 
      RowBox[{"Arg", "[", "E1p", "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Chop", "[", 
     RowBox[{"Times", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], "\[ImaginaryI]", " ", "\[Phi]"}]], ",", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "2"}], "\[ImaginaryI]", " ", "\[Phi]"}]]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"E1p", ",", "E1m", ",", "E2p", ",", "E2m"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"1505263b-11ac-4f55-8a36-c3944116e46d"]
}, Closed]],

Cell[CellGroupData[{

Cell["NLPTOutcomes", \
"Subsection",ExpressionUUID->"4aa37455-9644-48b4-bd2f-16f009a170cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NLPTOutcomes", "::", "usage"}], "=", 
    "\"\<NLPTOutcomes[{ReE1p,ImE1p,ReE1m,ImE1m,ReE2p,ImE2p,ReE2m,ImE2m}] \
Calculates the Nonlinear Polarization Tomography outcome functions \
\!\(\*SubscriptBox[\(I\), \(n\)]\), as defined in the paper, with the \
normalization set so that the \[ScriptL]>0 components of the paper are given \
by \!\(\*SubsuperscriptBox[\(I\), \(\[ScriptL]\), \(paper\)]\)(\[Theta])=Re(2\
\!\(\*SubscriptBox[\(I\), \(\[ScriptL]\)]\)\!\(\*SuperscriptBox[\(\
\[ExponentialE]\), \(\[ImaginaryI]\\\ \[ScriptL]\\\ \[Theta]\)]\)).\n\n\
NLPTOutcomes[{E1p,E1m,E2p,E2m}] Uses explicit complex amplitudes.\>\""}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NLPTOutcomes", "[", 
     RowBox[{"{", 
      RowBox[{
      "ReE1p_", ",", "ImE1p_", ",", "ReE1m_", ",", "ImE1m_", ",", "ReE2p_", 
       ",", "ImE2p_", ",", "ReE2m_", ",", "ImE2m_"}], "}"}], "]"}], "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "u", ",", "E1", ",", "E2", ",", "E1p", ",", "E1m", ",", "E2p", ",", 
        "E2m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"UnitE", "[", "1", "]"}], "E1p"}], "+", 
         RowBox[{
          RowBox[{"UnitE", "[", 
           RowBox[{"-", "1"}], "]"}], "E1m"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"E2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"UnitE", "[", "1", "]"}], "E2p"}], "+", 
         RowBox[{
          RowBox[{"UnitE", "[", 
           RowBox[{"-", "1"}], "]"}], "E2m"}]}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Expand", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Coefficient", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"TrigToExp", "[", "\[IndentingNewLine]", 
                RowBox[{
                 FractionBox["1", "2"], 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"u", ".", 
                    RowBox[{"E1", "\[Conjugate]"}]}], ")"}], "2"], "+", 
                   RowBox[{"u", ".", 
                    RowBox[{"E2", "\[Conjugate]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"u", ".", "E1"}], ")"}], "2"], "+", 
                   RowBox[{"u", ".", "E2"}]}], ")"}]}], "\[IndentingNewLine]",
                 "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", "\[Rule]", 
                 RowBox[{
                  FractionBox["1", "\[ImaginaryI]"], 
                  RowBox[{"Log", "[", "e\[ImaginaryI]\[Theta]", "]"}]}]}], 
                "}"}]}], "\[IndentingNewLine]", ",", "e\[ImaginaryI]\[Theta]",
               ",", "n"}], "]"}], "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"E1p", "\[Rule]", 
               RowBox[{"ReE1p", "+", 
                RowBox[{"\[ImaginaryI]", " ", "ImE1p"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"E1m", "\[Rule]", 
               RowBox[{"ReE1m", "+", 
                RowBox[{"\[ImaginaryI]", " ", "ImE1m"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"E2p", "\[Rule]", 
               RowBox[{"ReE2p", "+", 
                RowBox[{"\[ImaginaryI]", " ", "ImE2p"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"E2m", "\[Rule]", 
               RowBox[{"ReE2m", "+", 
                RowBox[{"\[ImaginaryI]", " ", "ImE2m"}]}]}]}], 
             "\[IndentingNewLine]", "}"}]}], "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"symbol_", "?", "AtomQ"}], "]"}], "\[Rule]", "symbol"}],
             "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NLPTOutcomes", "[", 
    RowBox[{"{", 
     RowBox[{"E1p_", ",", "E1m_", ",", "E2p_", ",", "E2m_"}], "}"}], "]"}], ":=", 
   RowBox[{"NLPTOutcomes", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Re", "[", "E1p", "]"}], ",", 
      RowBox[{"Im", "[", "E1p", "]"}], ",", 
      RowBox[{"Re", "[", "E1m", "]"}], ",", 
      RowBox[{"Im", "[", "E1m", "]"}], ",", 
      RowBox[{"Re", "[", "E2p", "]"}], ",", 
      RowBox[{"Im", "[", "E2p", "]"}], ",", 
      RowBox[{"Re", "[", "E2m", "]"}], ",", 
      RowBox[{"Im", "[", "E2m", "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"ae65895b-7533-477b-900c-c3f4768ed456"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReconstructionMimimizationTarget", \
"Subsection",ExpressionUUID->"7a6558e6-5120-4203-90e3-9e0489cdd325"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReconstructionMimimizationTarget", "::", "usage"}], "=", 
    "\"\<ReconstructionMimimizationTarget[{I0,I1,I2,I3,I4}][ReE1p,ImE1p,ReE1m,\
ImE1m,ReE2p,ImE2p,ReE2m,ImE2m] calculates the reconstruction target \
\!\(\*FormBox[RowBox[{UnderoverscriptBox[\"\[Sum]\", RowBox[{\"n\", \"=\", \
\"0\"}], \"4\",LimitsPositioning->True], RowBox[{\"|\", RowBox[{SubscriptBox[\
\"I\", \"n\"], \"-\", RowBox[{SubscriptBox[\"I\", \"n\"], \"(\", \"E\", \
\")\"}]}], SuperscriptBox[\"|\", \"2\"]}]}],TraditionalForm]\), i.e. the sum \
of squares of the nonlinear-polarimetry Fourier coefficients in difference \
between the given \!\(\*SubscriptBox[\(I\), \(n\)]\) and those reconstructed \
from the given complex fields.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ReconstructionMimimizationTarget", "[", 
      RowBox[{"{", 
       RowBox[{"I0_", ",", "I1_", ",", "I2_", ",", "I3_", ",", "I4_"}], "}"}],
       "]"}], "[", 
     RowBox[{
     "ReE1p_", ",", "ImE1p_", ",", "ReE1m_", ",", "ImE1m_", ",", "ReE2p_", 
      ",", "ImE2p_", ",", "ReE2m_", ",", "ImE2m_"}], "]"}], "=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "u", ",", "E1", ",", "E2", ",", "E1p", ",", "E1m", ",", "E2p", ",", 
        "E2m"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"E1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"UnitE", "[", "1", "]"}], "E1p"}], "+", 
         RowBox[{
          RowBox[{"UnitE", "[", 
           RowBox[{"-", "1"}], "]"}], "E1m"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"E2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"UnitE", "[", "1", "]"}], "E2p"}], "+", 
         RowBox[{
          RowBox[{"UnitE", "[", 
           RowBox[{"-", "1"}], "]"}], "E2m"}]}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Total", "[", 
        RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", "\[IndentingNewLine]", 
             RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ReIm", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NLPTOutcomes", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    "ReE1p", ",", "ImE1p", ",", "ReE1m", ",", "ImE1m", ",", 
                    "ReE2p", ",", "ImE2p", ",", "ReE2m", ",", "ImE2m"}], 
                    "}"}], "]"}], "\[LeftDoubleBracket]", 
                  RowBox[{"n", "+", "1"}], "\[RightDoubleBracket]"}], "-", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"I0", ",", "I1", ",", "I2", ",", "I3", ",", "I4"}],
                    "}"}], "\[LeftDoubleBracket]", 
                  RowBox[{"n", "+", "1"}], "\[RightDoubleBracket]"}]}], 
                "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
               RowBox[{"Assumptions", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    "ReE1p", ",", "ImE1p", ",", "ReE1m", ",", "ImE1m", ",", 
                    "ReE2p", ",", "ImE2p", ",", "ReE2m", ",", "ImE2m"}], 
                    "}"}], "\[Element]", "Reals"}], ",", 
                  RowBox[{"I0", "\[Element]", "Reals"}]}], "}"}]}]}], 
              "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}], 
            "2"], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "0", ",", "4"}], "}"}]}], "\[IndentingNewLine]",
           "]"}], "]"}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"ed61a97b-3c48-44e4-9571-8bf1a9e8f529"]
}, Closed]],

Cell[CellGroupData[{

Cell["ReconstructBicircularField", \
"Subsection",ExpressionUUID->"5e48f34a-cf6d-4b9e-90f2-94fbf2892c2d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ReconstructBicircularFieldList", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SortingFunction", "\[Rule]", 
        RowBox[{"Function", "[", 
         RowBox[{"#", "[", "\"\<Residual\>\"", "]"}], "]"}]}], ",", 
       RowBox[{"SelectionFunction", "\[Rule]", 
        RowBox[{"Function", "[", "True", "]"}]}], ",", 
       RowBox[{"Parallelize", "\[Rule]", "False"}]}], "}"}], ",", 
     RowBox[{"Options", "[", "FindMinimum", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ReconstructBicircularField", "]"}], "=", 
    RowBox[{"Options", "[", "ReconstructBicircularFieldList", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SortingFunction", "::", "usage"}], "=", 
   "\"\<SortingFunction is an option for ReconstructBicircularField and \
ReconstructBicircularFieldList that specifies a function (applied to the \
results of the form \
\[LeftAssociation]\\\"Fields\\\"\[Rule]{\!\(\*SubscriptBox[\(E\), \
\(\(1\)\(+\)\)]\),\!\(\*SubscriptBox[\(E\), \
\(\(1\)\(-\)\)]\),\!\(\*SubscriptBox[\(E\), \
\(\(2\)\(+\)\)]\),\!\(\*SubscriptBox[\(E\), \(\(2\)\(-\)\)]\)},\\\"Outcomes\\\
\"\[Rule]{\!\(\*SubscriptBox[\(I\), \(0, rec\)]\),\!\(\*SubscriptBox[\(I\), \
\(1, rec\)]\),\!\(\*SubscriptBox[\(I\), \(2, \
rec\)]\),\!\(\*SubscriptBox[\(I\), \(3, rec\)]\),\!\(\*SubscriptBox[\(I\), \
\(4, rec\)]\)},\\\"\!\(\*SqrtBox[\(Residual\)]\)\\\"\[Rule]r,\\\"Residual\\\"\
\[Rule]\!\(\*SuperscriptBox[\(r\), \(2\)]\)\[RightAssociation]) used to sort \
the individual minima.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SelectionFunction", "::", "usage"}], "=", 
   "\"\<SelectionFunction is an option for ReconstructBicircularField and \
ReconstructBicircularFieldList that specifies a function (applied to the \
results of the form \
\[LeftAssociation]\\\"Fields\\\"\[Rule]{\!\(\*SubscriptBox[\(E\), \
\(\(1\)\(+\)\)]\),\!\(\*SubscriptBox[\(E\), \
\(\(1\)\(-\)\)]\),\!\(\*SubscriptBox[\(E\), \
\(\(2\)\(+\)\)]\),\!\(\*SubscriptBox[\(E\), \(\(2\)\(-\)\)]\)},\\\"Outcomes\\\
\"\[Rule]{\!\(\*SubscriptBox[\(I\), \(0, rec\)]\),\!\(\*SubscriptBox[\(I\), \
\(1, rec\)]\),\!\(\*SubscriptBox[\(I\), \(2, \
rec\)]\),\!\(\*SubscriptBox[\(I\), \(3, rec\)]\),\!\(\*SubscriptBox[\(I\), \
\(4, rec\)]\)},\\\"\!\(\*SqrtBox[\(Residual\)]\)\\\"\[Rule]r,\\\"Residual\\\"\
\[Rule]\!\(\*SuperscriptBox[\(r\), \(2\)]\)\[RightAssociation], and returning \
True or False) used to keep or discard potential solutions.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", 
    RowBox[{"SortingFunction", ",", "SelectionFunction"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReconstructBicircularFieldList", "::", "usage"}], "=", 
    "\"\<ReconstructBicircularFieldList[{I0,I1,I2,I3,I4}] calculates a list \
of candidate reconstructed fields (each an Association of the form \
\[LeftAssociation]\\\"Fields\\\"\[Rule]{\!\(\*SubscriptBox[\(E\), \
\(\(1\)\(+\)\)]\),\!\(\*SubscriptBox[\(E\), \
\(\(1\)\(-\)\)]\),\!\(\*SubscriptBox[\(E\), \
\(\(2\)\(+\)\)]\),\!\(\*SubscriptBox[\(E\), \(\(2\)\(-\)\)]\)},\\\"Outcomes\\\
\"\[Rule]{\!\(\*SubscriptBox[\(I\), \(0, rec\)]\),\!\(\*SubscriptBox[\(I\), \
\(1, rec\)]\),\!\(\*SubscriptBox[\(I\), \(2, \
rec\)]\),\!\(\*SubscriptBox[\(I\), \(3, rec\)]\),\!\(\*SubscriptBox[\(I\), \
\(4, rec\)]\)},\\\"\!\(\*SqrtBox[\(Residual\)]\)\\\"\[Rule]r,\\\"Residual\\\"\
\[Rule]\!\(\*SuperscriptBox[\(r\), \(2\)]\)\[RightAssociation]), obtained by \
minimizing ReconstructionMimimizationTarget over a list of random initial \
seeds pulled from a box of side 1.\n\n\
ReconstructBicircularFieldList[{I0,I1,I2,I3,I4},Erange] uses a box of side \
Erange (which can be a single number, or a list of eight real numbers to be \
used as the sizes of the boxes for \
{ReE1p,ImE1p,ReE1m,ImE1m,ReE2p,ImE2p,ReE2m,ImE2m}) for the initial seeds of \
the minimization.\n\n\
ReconstructBicircularFieldList[{I0,I1,I2,I3,I4},Erange,iterations] uses the \
specified number of iterations.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ReconstructBicircularField", "::", "usage"}], "=", 
    "\"\<ReconstructBicircularField[{I0,I1,I2,I3,I4}] returns the first \
element of the corresponding ReconstructBicircularFieldList, using the \
specified (or default) SortingFunction.\n\n\
ReconstructBicircularField[{I0,I1,I2,I3,I4},Erange] returns the first element \
of the corresponding ReconstructBicircularFieldList, using the specified (or \
default) SortingFunction.\n\n\
ReconstructBicircularField[{I0,I1,I2,I3,I4},Erange,iterations] returns the \
first element of the corresponding ReconstructBicircularFieldList, using the \
specified (or default) SortingFunction.\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReconstructBicircularField", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"I0_", ",", "I1_", ",", "I2_", ",", "I3_", ",", "I4_"}], "}"}], 
     ",", 
     RowBox[{"Erange_:", "1"}], ",", 
     RowBox[{"iterations_:", "20"}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"First", "[", "\[IndentingNewLine]", 
    RowBox[{"ReconstructBicircularFieldList", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"I0", ",", "I1", ",", "I2", ",", "I3", ",", "I4"}], "}"}], ",",
       "Erange", ",", "iterations", ",", "options"}], "]"}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ReconstructBicircularFieldList", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"I0_", ",", "I1_", ",", "I2_", ",", "I3_", ",", "I4_"}], "}"}], 
     ",", 
     RowBox[{"Erange_:", "1"}], ",", 
     RowBox[{"iterations_:", "20"}], ",", 
     RowBox[{"options", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"SortBy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "Parallelize", "]"}], "\[Equal]", 
             "True"}], ",", "Parallelize", ",", 
            RowBox[{"#", "&"}]}], "]"}], "@", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Function", "[", 
              RowBox[{"solution", ",", 
               RowBox[{"Block", "[", 
                RowBox[{
                 RowBox[{"{", "fields", "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"fields", "=", 
                   RowBox[{"PhaseNormalization", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    "EnsureRightCircularFundamental", "[", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ReE1p", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "ImE1p"}]}], ",", 
                    RowBox[{"ReE1m", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "ImE1m"}]}], ",", 
                    RowBox[{"ReE2p", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "ImE2p"}]}], ",", 
                    RowBox[{"ReE2m", "+", 
                    RowBox[{"\[ImaginaryI]", " ", "ImE2m"}]}]}], "}"}], "/.", 
                    RowBox[{
                    "solution", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "]"}],
                     "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"\[LeftAssociation]", 
                   RowBox[{
                    RowBox[{"\"\<Fields\>\"", "\[Rule]", "fields"}], ",", 
                    RowBox[{"\"\<Outcomes\>\"", "\[Rule]", 
                    RowBox[{"NLPTOutcomes", "[", "fields", "]"}]}], ",", 
                    RowBox[{
                    "\"\<\!\(\*SqrtBox[\(Residual\)]\)\>\"", "\[Rule]", 
                    SqrtBox[
                    RowBox[{
                    "solution", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]]}], ",", 
                    RowBox[{"\"\<Residual\>\"", "\[Rule]", 
                    RowBox[{
                    "solution", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], 
                   "\[RightAssociation]"}]}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "]"}], "[", 
             "\[IndentingNewLine]", 
             RowBox[{"FindMinimum", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"ReconstructionMimimizationTarget", "[", 
                 RowBox[{"{", 
                  RowBox[{"I0", ",", "I1", ",", "I2", ",", "I3", ",", "I4"}], 
                  "}"}], "]"}], "[", 
                RowBox[{
                "ReE1p", ",", "ImE1p", ",", "ReE1m", ",", "ImE1m", ",", 
                 "ReE2p", ",", "ImE2p", ",", "ReE2m", ",", "ImE2m"}], "]"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"Transpose", "[", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                   "ReE1p", ",", "ImE1p", ",", "ReE1m", ",", "ImE1m", ",", 
                    "ReE2p", ",", "ImE2p", ",", "ReE2m", ",", "ImE2m"}], 
                   "}"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"Erange", " ", 
                   RowBox[{"RandomReal", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "8"}], 
                    "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Method", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"\"\<Newton\>\"", ",", 
                  RowBox[{"StepControl", "\[Rule]", "\"\<TrustRegion\>\""}]}],
                  "}"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"Evaluate", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"FilterRules", "[", 
                  RowBox[{
                   RowBox[{"{", "options", "}"}], ",", 
                   RowBox[{"Options", "[", "FindMinimum", "]"}]}], "]"}]}], 
                "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
             "]"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", "iterations", "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"OptionValue", "[", "SelectionFunction", "]"}]}], "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"OptionValue", "[", "SortingFunction", "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"4e02e7ea-e825-44d9-8e72-fea1305b1277"]
}, Closed]],

Cell[CellGroupData[{

Cell["Package closure", \
"Subsection",ExpressionUUID->"c4ab4a77-e2dd-4fc0-a41b-1a66eeb20238"],

Cell[CellGroupData[{

Cell["End of package", \
"Subsubsection",ExpressionUUID->"5c22c003-8445-4e4a-b7c4-4bb055378951"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"41e28dd9-26c5-47b9-8875-713ef3971763"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Add to distributed contexts.", \
"Subsubsection",ExpressionUUID->"bd47262e-0fd3-4089-bc7d-399fe29bf374"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DistributeDefinitions", "[", "\"\<LIRE`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"80571e19-793e-4d30-a315-1c3eda65d555"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
NotebookEventActions->{{"MenuCommand", "Save"} :> (NotebookWrite[
     Part[
      Cells[CellTags -> "version-timestamp"], 1], 
     Cell[
      BoxData[
       RowBox[{
         StringJoin["Begin[\"`Private`\"];$LIREtimestamp=\"", 
          DateString[], "\";End[];"]}]], "Input", InitializationCell -> True, 
      CellTags -> "version-timestamp"], None, AutoScroll -> False]; 
   NotebookSave[]), PassEventsDown -> True},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingStartingPageNumber->1,
PrintingPageRange->{Automatic, Automatic},
PageHeaders->{{None, None, 
   Cell[
    TextData[{
     "RB", "-", "SFA", ":", " ", "Rotating", " ", "Bicircular", " ", "HHG", 
      " ", "in", " ", "the", " ", "Strong", " ", "Field", " ", 
      "Approximation", "|", "   ", 
      StyleBox[
       CounterBox["Page"], "PageNumber"]}], "Header", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}, {None, None, 
   Cell[
    TextData[{
     "RB", "-", "SFA", ":", " ", "Rotating", " ", "Bicircular", " ", "HHG", 
      " ", "in", " ", "the", " ", "Strong", " ", "Field", " ", 
      "Approximation", "|", "   ", 
      StyleBox[
       CounterBox["Page"], "PageNumber"]}], "Header", 
    CellMargins -> {{Inherited, 0}, {Inherited, Inherited}}]}},
PageFooters->{{None, None, None}, {None, None, None}},
PageHeaderLines->{False, False},
PageFooterLines->{False, False},
PrintingOptions->{"FacingPages"->True,
"FirstPageFace"->Right,
"FirstPageFooter"->True,
"FirstPageHeader"->False,
"PaperOrientation"->"Portrait",
"PaperSize"->{594.75, 842.25},
"PostScriptOutputFile"->"~/Desktop/print.pdf",
"PrintingMargins"->{{19.84251968503, 19.84251968503}, {72., 72.}}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
TrackCellChangeTimes->False,
SpellingDictionaries->{"CorrectWords"->{
 "subpackage", "Pisanty", "subpackages"}},
Background->None,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[StyleDefinitions -> "Default.nb"]], 
   Cell[
    StyleData["Code"], FontWeight -> "Plain", FontSlant -> "Plain", 
    FontTracking -> "Plain", 
    FontVariations -> {
     "Outline" -> False, "Shadow" -> False, "StrikeThrough" -> False, 
      "Underline" -> False}]}, Visible -> False, FrontEndVersion -> 
  "11.2 for Microsoft Windows (64-bit) (September 10, 2017)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]

